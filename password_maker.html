<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Password Maker | Key Safe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Add Google Fonts Inter -->
    <link href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: #232326;
            --card-bg: #3a3a3e;
            --primary: #2d8cff;
            --primary-hover: #2063bb;
            --text: #fff;
            --muted: #b0b6c4;
            --button-bg: #3a3a3e;
            --button-hover: #232326;
            --button-text: #fff;
            --bar-bg: #3a3a3e;
            --menu-bg: #3a3a3e;
            --menu-link-bg: #232326;
            --menu-link-text: #fff;
            --menu-border: #44444b;
            --menu-fade: 0.35s cubic-bezier(.55,.06,.68,.19);
            --logout-bg: #232326;
            --logout-hover-bg: #ff5757;
            --danger: #ff5757;
            --card-radius: 18px;
            --card-padding: 32px 24px;
            --input-padding-x: 16px;
        }
        body {
            margin: 0;
            padding: 0;
            background: var(--background);
            color: var(--text);
            font-family: 'Inter', Arial, sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .top-bar {
            width: 100%;
            height: 60px;
            background: var(--bar-bg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-sizing: border-box;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
        }
        .bar-left {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--text);
        }
        .bar-menu {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            cursor: pointer;
            position: relative;
            z-index: 101;
            background: none;
            border: none;
        }
        .bar-menu-bars, .bar-menu-x {
            width: 28px;
            height: 28px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .bar-menu-bars span {
            display: block;
            height: 4px;
            width: 100%;
            background: #fff;
            margin: 3.5px 0;
            border-radius: 2px;
            transition: background 0.3s;
        }
        .bar-menu-x {
            position: absolute;
            top: 0;
            right: 0;
            width: 32px;
            height: 32px;
            display: none;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background: none;
        }
        .bar-menu-x span {
            position: absolute;
            width: 24px;
            height: 4px;
            top: 50%;
            left: 50%;
            background: #fff;
            border-radius: 2px;
            transition:
                transform 0.35s cubic-bezier(.55,.06,.68,.19),
                opacity 0.18s,
                background 0.2s;
        }
        .bar-menu-x .x1 {
            transform: translate(-50%, -50%) rotate(45deg);
        }
        .bar-menu-x .x2 {
            transform: translate(-50%, -50%) rotate(-45deg);
        }
        /* The X is always visible when menu is open */
        .menu-overlay .bar-menu-x {
            display: flex !important;
            position: absolute;
            top: 30px;
            right: 30px;
            z-index: 201;
            background: none;
        }
        .menu-overlay .bar-menu-x:hover span {
            background: var(--primary);
        }
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--menu-bg);
            color: #fff;
            z-index: 200;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--menu-fade);
        }
        .menu-overlay.active {
            display: flex;
            pointer-events: all;
            opacity: 1;
            animation: fadeInMenu 0.4s;
        }
        .menu-overlay.closing {
            opacity: 0;
            pointer-events: none;
            animation: fadeOutMenu 0.35s cubic-bezier(.55,.06,.68,.19);
        }
        @keyframes fadeInMenu {
            from { opacity: 0;}
            to { opacity: 1;}
        }
        @keyframes fadeOutMenu {
            from { opacity: 1;}
            to { opacity: 0;}
        }
        .menu-list {
            width: 90%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            gap: 22px;
        }
        .menu-item-card {
            background: var(--menu-link-bg);
            color: var(--menu-link-text);
            border-radius: 12px;
            padding: 0;
            box-shadow: 0 4px 14px #0003;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
            cursor: pointer;
            border: none;
            outline: none;
        }
        .menu-item {
            font-size: 1.3rem;
            padding: 24px 0;
            text-align: center;
            color: var(--menu-link-text);
            border: none;
            border-radius: 12px;
            background: none;
            transition: color 0.2s;
            font-family: 'Inter', Arial, sans-serif;
        }
        .menu-item-card:hover {
            box-shadow: 0 4px 20px #2d8cff55, 0 2px 8px #0005;
        }
        .menu-item:hover {
            color: var(--primary);
            background: none;
        }
        /* Special style for Logout */
        .menu-item-card.logout {
            background: var(--logout-bg) !important;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        }
        .menu-item-card.logout .menu-item {
            color: #fff !important;
        }
        .menu-item-card.logout:hover {
            background: var(--logout-hover-bg) !important;
            box-shadow: 0 4px 20px #ff575733, 0 2px 8px #0005;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .top-bar {
                padding: 0 12px;
            }
            .menu-list {
                max-width: 99vw;
                width: 99vw;
                border-radius: 0;
                margin-top: 62px;
            }
        }
        .container {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: flex-start;
            gap: 32px;
            padding: 90px 32px 32px 32px;
            min-height: 100vh;
            box-sizing: border-box;
            opacity: 0;
            transform: translateY(32px) scale(0.98);
            animation: fadeInUp 0.7s cubic-bezier(.55,.06,.68,.19) 0.05s forwards;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(32px) scale(0.98);}
            to { opacity: 1; transform: translateY(0) scale(1);}
        }
        .card {
            background: var(--card-bg);
            border-radius: var(--card-radius);
            box-shadow: 0 4px 24px #0007;
            padding: var(--card-padding);
            flex: 1 1 0;
            min-width: 320px;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-sizing: border-box;
            opacity: 0;
            transform: translateY(44px) scale(0.97);
            animation: cardIn 0.7s cubic-bezier(.55,.06,.68,.19) 0.18s forwards;
        }
        .card:nth-child(2) { animation-delay: 0.3s;}
        .card:nth-child(3) { animation-delay: 0.45s;}
        @keyframes cardIn {
            from { opacity: 0; transform: translateY(44px) scale(0.97);}
            to { opacity: 1; transform: translateY(0) scale(1);}
        }
        .card h2 {
            font-size: 1.25rem;
            font-weight: bold;
            margin: 0 0 14px 0;
            letter-spacing: 1px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin-bottom: 0;
        }
        .input-row {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group select {
            width: 100%;
            padding: 10px var(--input-padding-x);
            border-radius: 8px;
            border: 1.5px solid #44444b;
            background: #232326;
            color: var(--text);
            font-family: 'Inter', Arial, sans-serif;
            font-size: 1rem;
            margin-bottom: 0;
            transition: border-color 0.2s;
            box-sizing: border-box;
        }
        .form-group label {
            margin-bottom: 0;
            font-size: 1rem;
            color: var(--text);
            font-weight: 500;
        }
        .input-row label {
            margin-bottom: 0;
        }
        input[type="text"]:focus, input[type="number"]:focus, select:focus {
            border-color: var(--primary);
            outline: none;
        }
        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 11px;
            margin-bottom: 0;
        }
        .checkbox-row label {
            margin: 0;
            font-size: 1rem;
            color: var(--text);
        }
        input[type="checkbox"] {
            width: 17px;
            height: 17px;
            accent-color: var(--primary);
        }
        .generate-btn {
            margin-top: 10px;
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            padding: 13px 0;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'Inter', Arial, sans-serif;
            cursor: pointer;
            transition: background 0.2s;
        }
        .generate-btn:hover {
            background: var(--button-hover);
        }
        .password-list {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin-top: 16px;
        }
        .password-output {
            background: #232326;
            color: #fff;
            padding: 18px 15px;
            border-radius: 10px;
            font-size: 1.13rem;
            font-family: 'Inter', monospace;
            letter-spacing: 0.06em;
            word-break: break-all;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border 0.2s, background 0.2s;
            user-select: all;
            position: relative;
        }
        .password-output:hover {
            border: 2px solid var(--primary);
            background: #252a34;
        }
        .copied-badge {
            font-size: 0.95em;
            color: var(--primary);
            position: absolute;
            right: 12px;
            top: 10px;
            background: #181a20e0;
            padding: 2px 8px;
            border-radius: 7px;
            font-weight: 600;
            pointer-events: none;
        }
        .info {
            color: var(--muted);
            font-size: 0.97em;
            line-height: 1.5;
        }
        .warn {
            color: var(--danger);
            font-size: 1em;
            margin-bottom: 6px;
            background: #ff57570c;
            border-radius: 7px;
            padding: 7px 11px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="bar-left" id="barLeft">Password Maker</div>
        <button class="bar-menu" id="barMenuBtn" title="Open menu" aria-label="Menu">
            <div class="bar-menu-bars" id="menuBars" style="display:flex">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
    </div>
    <div class="menu-overlay" id="menuOverlay">
        <div class="bar-menu-x" id="menuX" style="display:flex">
            <span class="x1"></span>
            <span class="x2"></span>
        </div>
        <div class="menu-list">
            <div class="menu-item-card home" id="menuHome">
                <div class="menu-item">Home</div>
            </div>
            <div class="menu-item-card"><div class="menu-item" id="menuPasswordMaker">Password Maker</div></div>
            <div class="menu-item-card"><div class="menu-item" id="menuPasswordChecker">Password Security Checker</div></div>
            <div class="menu-item-card"><div class="menu-item" id="menuSavedPasswords">Saved Passwords</div></div>
            <div class="menu-item-card"><div class="menu-item" id="menuFAQ">FAQ</div></div>
            <div class="menu-item-card"><div class="menu-item" id="menuAbout">About</div></div>
            <div class="menu-item-card logout"><div class="menu-item" id="menuLogout">Log Out</div></div>
        </div>
    </div>
    <div class="container">
        <!-- Card 1: Optional Questions -->
        <div class="card" id="optionalCard">
            <h2>Optional Questions</h2>
            <div class="info">Fill in any for a personal touch (these are not stored!)</div>
            <div class="form-group">
                <div class="input-row">
                    <label for="favColor">What's your favorite color? <span style="color:var(--muted);font-size:0.95em;">(optional)</span></label>
                    <input type="text" id="favColor" maxlength="32" autocomplete="off">
                </div>
                <div class="input-row">
                    <label for="favAnimal">What's your favorite animal? <span style="color:var(--muted);font-size:0.95em;">(optional)</span></label>
                    <input type="text" id="favAnimal" maxlength="32" autocomplete="off">
                </div>
                <div class="input-row">
                    <label for="birthMonth">What month were you born? <span style="color:var(--muted);font-size:0.95em;">(optional)</span></label>
                    <select id="birthMonth">
                        <option value=""></option>
                        <option>January</option><option>February</option><option>March</option><option>April</option>
                        <option>May</option><option>June</option><option>July</option><option>August</option>
                        <option>September</option><option>October</option><option>November</option><option>December</option>
                    </select>
                </div>
                <div class="input-row">
                    <label for="customWord">A word that's meaningful to you? <span style="color:var(--muted);font-size:0.95em;">(optional)</span></label>
                    <input type="text" id="customWord" maxlength="32" autocomplete="off">
                </div>
            </div>
        </div>
        <!-- Card 2: Requirements -->
        <div class="card" id="requirementsCard">
            <h2>Password Requirements</h2>
            <div id="warnMsg" class="warn" style="display:none;"></div>
            <div class="form-group">
                <div class="checkbox-row">
                    <input type="checkbox" id="reqNumbers" checked>
                    <label for="reqNumbers">Include numbers (0-9)</label>
                </div>
                <div class="checkbox-row">
                    <input type="checkbox" id="reqSymbols" checked>
                    <label for="reqSymbols">Include symbols (!@#$...)</label>
                </div>
                <div class="checkbox-row">
                    <input type="checkbox" id="reqUppercase" checked>
                    <label for="reqUppercase">Include uppercase letters (A-Z)</label>
                </div>
                <div class="checkbox-row">
                    <input type="checkbox" id="reqLowercase" checked>
                    <label for="reqLowercase">Include lowercase letters (a-z)</label>
                </div>
                <div class="checkbox-row">
                    <input type="checkbox" id="reqAvoidAmbig">
                    <label for="reqAvoidAmbig">Avoid ambiguous characters (e.g. l, 1, I, 0, O)</label>
                </div>
                <div class="input-row">
                    <label for="reqLength">Password length (8-64):</label>
                    <input type="number" id="reqLength" min="8" max="64" value="16">
                </div>
                <div class="input-row">
                    <label for="reqCount">How many passwords? (1-5):</label>
                    <input type="number" id="reqCount" min="1" max="5" value="3">
                </div>
            </div>
            <button class="generate-btn" id="generateBtn">Generate Passwords</button>
        </div>
        <!-- Card 3: Output -->
        <div class="card" id="outputCard">
            <h2>Strong Passwords</h2>
            <div class="info" id="outputInfo">Click a password to copy it to your clipboard.<br>Passwords are <b>never stored</b> and will disappear if you leave or switch tabs/apps.</div>
            <div class="password-list" id="passwordList"></div>
        </div>
    </div>
    <script>
        // Menu logic
        function getLoggedInUser() {
            return localStorage.getItem("keysafe-logged-in");
        }
        document.getElementById("barLeft").textContent = "Password Maker";

        // Menu toggle and X animation
        const menuBtn = document.getElementById("barMenuBtn");
        const menuOverlay = document.getElementById("menuOverlay");
        const menuBars = document.getElementById("menuBars");
        const menuX = document.getElementById("menuX");
        let menuOpen = false;
        let menuCloseTimeout = null;

        menuBtn.onclick = function(e) {
            e.stopPropagation();
            if (!menuOpen) {
                menuOverlay.classList.add("active");
                menuOverlay.classList.remove("closing");
                menuBars.style.display = "none";
                menuOpen = true;
            }
        };
        menuX.onclick = function(e) {
            e.stopPropagation();
            if (menuOpen) {
                menuOverlay.classList.remove("active");
                menuOverlay.classList.add("closing");
                menuBars.style.display = "flex";
                menuOpen = false;
                clearTimeout(menuCloseTimeout);
                menuCloseTimeout = setTimeout(() => {
                    menuOverlay.classList.remove("closing");
                }, 350);
            }
        };
        menuOverlay.onclick = function(e) {
            if(e.target === menuOverlay && menuOpen) {
                menuX.onclick(e);
            }
        };
        function closeMenu() {
            if (menuOpen) {
                menuX.onclick(new Event("click"));
            }
        }

        // Menu items logic
        document.getElementById("menuHome").onclick = function() {
            closeMenu();
            window.location.href = "index.html";
        };
        document.getElementById("menuPasswordMaker").onclick = function() {
            closeMenu();
            window.location.href = "password_maker.html";
        };
        document.getElementById("menuPasswordChecker").onclick = function() {
            closeMenu();
            window.location.href = "password_checker.html";
        };
        document.getElementById("menuSavedPasswords").onclick = function() {
            closeMenu();
            window.location.href = "password_saved.html";
        };
        document.getElementById("menuFAQ").onclick = function() {
            closeMenu();
            window.location.href = "faq.html";
        };
        document.getElementById("menuAbout").onclick = function() {
            closeMenu();
            window.open("https://kingfarooq.github.io", "_blank");
        };
        document.getElementById("menuLogout").onclick = function() {
            localStorage.removeItem("keysafe-logged-in");
            window.location.href = "login_signup.html";
        };

        // Disappear passwords on page hide or tab switch/app switch
        const passwordList = document.getElementById('passwordList');
        let passwords = [];
        let copiedTimeout = null;

        function clearPasswords() {
            passwords = [];
            passwordList.innerHTML = '';
        }
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                clearPasswords();
            }
        });
        window.addEventListener("beforeunload", function() {
            clearPasswords();
        });

        function showWarning(msg) {
            var warn = document.getElementById("warnMsg");
            if (msg) {
                warn.style.display = "";
                warn.innerText = msg;
            } else {
                warn.style.display = "none";
                warn.innerText = "";
            }
        }
        function getRandomCharFrom(str) {
            return str.charAt(Math.floor(Math.random() * str.length));
        }
        function shuffle(str) {
            return str.split('').sort(() => 0.5 - Math.random()).join('');
        }
        function generatePassword(requirements, customWords) {
            let numbers = "0123456789";
            let symbols = "!@#$%^&*()_+-=<>[]{}|,.?/~";
            let lower = "abcdefghijklmnopqrstuvwxyz";
            let upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            let ambig = "il1Lo0O";
            let chars = "";
            let minCategories = [];
            if (requirements.numbers) { chars += numbers; minCategories.push(numbers);}
            if (requirements.symbols) { chars += symbols; minCategories.push(symbols);}
            if (requirements.uppercase) { chars += upper; minCategories.push(upper);}
            if (requirements.lowercase) { chars += lower; minCategories.push(lower);}
            if (requirements.avoidAmbig) {
                chars = chars.split('').filter(c => !ambig.includes(c)).join('');
                minCategories = minCategories.map(cat => cat.split('').filter(c => !ambig.includes(c)).join(''));
            }
            if (!chars.length) { chars = ""; }
            let pool = chars + (customWords.join(''));
            if (!pool.length) pool = lower + upper + numbers + symbols;
            let result = "";
            for (let cat of minCategories) {
                if (cat.length > 0 && result.length < requirements.length) {
                    result += getRandomCharFrom(cat);
                }
            }
            while (result.length < requirements.length) {
                result += getRandomCharFrom(pool);
            }
            result = shuffle(result);
            if (customWords.length > 0 && requirements.length > 10 && Math.random() > 0.5) {
                let word = customWords[Math.floor(Math.random() * customWords.length)];
                if (word.length <= requirements.length - 4 && /^[a-zA-Z0-9]+$/.test(word)) {
                    let idx = Math.floor(Math.random() * (requirements.length - word.length));
                    result = result.slice(0, idx) + word + result.slice(idx + word.length);
                }
            }
            return result.slice(0, requirements.length);
        }
        function collectCustomWords() {
            let words = [];
            let color = document.getElementById('favColor').value.trim();
            let animal = document.getElementById('favAnimal').value.trim();
            let word = document.getElementById('customWord').value.trim();
            let month = document.getElementById('birthMonth').value.trim();
            if (color) words.push(color);
            if (animal) words.push(animal);
            if (word) words.push(word);
            if (month) words.push(month);
            return words;
        }
        function assessPasswordStrength(requirements) {
            let enabled = [
                requirements.numbers,
                requirements.symbols,
                requirements.uppercase,
                requirements.lowercase
            ].filter(Boolean).length;
            let warn = "";
            if (enabled <= 1) {
                warn += "Warning: Your password may NOT be strong because you only selected ";
                if (requirements.numbers) warn += "numbers";
                else if (requirements.symbols) warn += "symbols";
                else if (requirements.uppercase) warn += "uppercase letters";
                else if (requirements.lowercase) warn += "lowercase letters";
                warn += ". Consider enabling more options for a stronger password.";
            } else if (requirements.length < 12) {
                warn += "Warning: Passwords shorter than 12 characters may be weak. Use longer passwords for extra security.";
            }
            return warn;
        }
        function updateWarning() {
            let requirements = {
                numbers: document.getElementById('reqNumbers').checked,
                symbols: document.getElementById('reqSymbols').checked,
                uppercase: document.getElementById('reqUppercase').checked,
                lowercase: document.getElementById('reqLowercase').checked,
                avoidAmbig: document.getElementById('reqAvoidAmbig').checked,
                length: Math.max(8, Math.min(64, parseInt(document.getElementById('reqLength').value) || 16))
            };
            let warn = assessPasswordStrength(requirements);
            showWarning(warn);
        }
        [
            'reqNumbers','reqSymbols','reqUppercase','reqLowercase','reqAvoidAmbig','reqLength'
        ].forEach(id => {
            document.getElementById(id).addEventListener("input", updateWarning);
            document.getElementById(id).addEventListener("change", updateWarning);
        });
        document.getElementById('generateBtn').onclick = function(e) {
            e.preventDefault();
            clearPasswords();
            let requirements = {
                numbers: document.getElementById('reqNumbers').checked,
                symbols: document.getElementById('reqSymbols').checked,
                uppercase: document.getElementById('reqUppercase').checked,
                lowercase: document.getElementById('reqLowercase').checked,
                avoidAmbig: document.getElementById('reqAvoidAmbig').checked,
                length: Math.max(8, Math.min(64, parseInt(document.getElementById('reqLength').value) || 16))
            };
            let count = Math.max(1, Math.min(5, parseInt(document.getElementById('reqCount').value) || 3));
            let customWords = collectCustomWords();
            if (!(requirements.numbers || requirements.symbols || requirements.uppercase || requirements.lowercase)) {
                showWarning("Please select at least one character type (numbers, symbols, uppercase, lowercase)!");
                return;
            } else {
                showWarning(assessPasswordStrength(requirements));
            }
            for (let i = 0; i < count; ++i) {
                passwords.push(generatePassword(requirements, customWords));
            }
            renderPasswords();
        };
        function renderPasswords() {
            passwordList.innerHTML = '';
            passwords.forEach((pw, idx) => {
                const div = document.createElement('div');
                div.className = 'password-output';
                div.tabIndex = 0;
                div.setAttribute('role', 'button');
                div.setAttribute('aria-label', 'Copy password');
                div.innerText = pw;
                div.onclick = function() {
                    navigator.clipboard.writeText(pw);
                    showCopied(div);
                };
                div.onkeydown = function(e) {
                    if (e.key === "Enter" || e.key === " ") {
                        div.onclick();
                    }
                };
                passwordList.appendChild(div);
            });
        }
        function showCopied(div) {
            document.querySelectorAll('.copied-badge').forEach(el => el.remove());
            const badge = document.createElement('span');
            badge.className = "copied-badge";
            badge.innerText = "Copied!";
            div.appendChild(badge);
            if (copiedTimeout) clearTimeout(copiedTimeout);
            copiedTimeout = setTimeout(() => {
                if (badge.parentNode) badge.parentNode.removeChild(badge);
            }, 1200);
        }
        window.onload = function() {
            clearPasswords();
            updateWarning();
        };
        window.onpageshow = function(e) { if (e.persisted) clearPasswords(); };
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) clearPasswords();
        });
        window.addEventListener("beforeunload", function() { clearPasswords(); });
    </script>
</body>
</html>

<!--
    Notes:
    - Personalization Features
    - No storage
    - Auto Clear
    - Click to copy
    - Clean UI
    
-->